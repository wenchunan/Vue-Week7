"use strict";(self["webpackChunkweek6_homework"]=self["webpackChunkweek6_homework"]||[]).push([[599],{2030:function(e,o,t){var l=t(7424),n=t.n(l);o["Z"]={methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(n())(this.$refs.modal)}}},4246:function(e,o,t){t.d(o,{Z:function(){return g}});var l=t(6252),n=t(3577);const a={class:"modal fade",id:"delProductModal",tabindex:"-1",role:"dialog","aria-labelledby":"delProductModalLabel","aria-hidden":"true",ref:"modal"},d={class:"modal-dialog"},s={class:"modal-content"},u={class:"modal-header bg-danger text-white"},i={class:"model-title",id:"delProductModalLable"},p=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),c={class:"modal-body"},r=(0,l.Uk)(" 是否刪除 "),m={class:"text-danger"},h=(0,l.Uk)(" 商品(刪除後將無法恢復) "),b={class:"modal-footer"},_=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function C(e,o,t,C,w,f){return(0,l.wg)(),(0,l.iD)("div",a,[(0,l._)("div",d,[(0,l._)("div",s,[(0,l._)("div",u,[(0,l._)("h5",i,[(0,l._)("span",null,"刪除 "+(0,n.zw)(t.tempProduct.title),1)]),p]),(0,l._)("div",c,[r,(0,l._)("strong",m,(0,n.zw)(t.tempProduct.title),1),h]),(0,l._)("div",b,[_,(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:o[0]||(o[0]=o=>e.$emit("del-item"))}," 確認刪除 ")])])])],512)}var w=t(2030),f={data(){return{modal:""}},props:{tempProduct:{}},mixins:[w.Z]},v=t(3744);const y=(0,v.Z)(f,[["render",C]]);var g=y},3599:function(e,o,t){t.r(o),t.d(o,{default:function(){return E}});var l=t(6252),n=t(3577);const a={class:"container"},d={class:"text-end mt-4"},s={class:"table mt-4"},u=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"名稱"),(0,l._)("th",null,"折扣百分比"),(0,l._)("th",null,"到期日"),(0,l._)("th",null,"是否啟用"),(0,l._)("th",null,"編輯")])],-1),i={key:0,class:"text-success"},p={key:1},c={class:"btn-group"},r=["onClick"],m=["onClick"];function h(e,o,t,h,b,_){const C=(0,l.up)("AdminCouponModal"),w=(0,l.up)("AdminDelProduct");return(0,l.wg)(),(0,l.iD)("div",a,[(0,l._)("div",d,[(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:o[0]||(o[0]=e=>_.openCouponModal(!0))}," 建立新的優惠券 ")]),(0,l._)("table",s,[u,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(b.coupons,(o=>((0,l.wg)(),(0,l.iD)("tr",{key:o.id},[(0,l._)("td",null,(0,n.zw)(o.title),1),(0,l._)("td",null,(0,n.zw)(o.percent)+"%",1),(0,l._)("td",null,(0,n.zw)(e.$filters.date(o.due_date)),1),(0,l._)("td",null,[1===o.is_enabled?((0,l.wg)(),(0,l.iD)("span",i,"啟用")):((0,l.wg)(),(0,l.iD)("span",p,"未啟用"))]),(0,l._)("td",null,[(0,l._)("div",c,[(0,l._)("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:e=>_.openCouponModal(!1,o)}," 編輯",8,r),(0,l._)("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:e=>_.openDelCouponModal(o)}," 刪除 ",8,m)])])])))),128))])]),(0,l.Wm)(C,{coupon:b.tempCoupon,ref:"couponModal",isNew:b.isNew,onUpdateCoupon:_.updateCoupon},null,8,["coupon","isNew","onUpdateCoupon"]),(0,l.Wm)(w,{tempProduct:b.tempCoupon,ref:"delModal",onDelItem:_.delCoupon},null,8,["tempProduct","onDelItem"])])}var b=t(9963);const _={class:"modal fade",id:"productModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},C={class:"modal-dialog"},w={class:"modal-content"},f={class:"modal-header"},v={class:"modal-title",id:"couponModalLabel"},y={key:0},g={key:1},M=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),k={class:"modal-body"},D={class:"mb-3"},x=(0,l._)("label",{for:"title",class:"form-label"},"標題",-1),$={class:"mb-3"},N=(0,l._)("label",{for:"coupon_code",class:"form-label"},"優惠碼",-1),P={class:"mb-3"},U=(0,l._)("label",{for:"due_date"},"到期日",-1),Z={class:"mb-3"},z=(0,l._)("label",{for:"price",class:"form-label"},"折扣百分比",-1),V={class:"mb-3"},A={class:"form-check"},L=(0,l._)("label",{for:"is_enabled",class:"form-check-label"},"是否啟用",-1),I={class:"modal-footer"},O=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1);function S(e,o,t,a,d,s){return(0,l.wg)(),(0,l.iD)("div",_,[(0,l._)("div",C,[(0,l._)("div",w,[(0,l._)("div",f,[(0,l._)("h5",v,[t.isNew?((0,l.wg)(),(0,l.iD)("span",y,"新增優惠券")):((0,l.wg)(),(0,l.iD)("span",g,"編輯優惠券"))]),M]),(0,l._)("div",k,[(0,l._)("div",D,[x,(0,l.wy)((0,l._)("input",{type:"text",id:"title",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":o[0]||(o[0]=e=>d.tempCoupon.title=e)},null,512),[[b.nr,d.tempCoupon.title]])]),(0,l._)("div",$,[N,(0,l.wy)((0,l._)("input",{type:"text",id:"coupon_code",class:"form-control",placeholder:"請輸入優惠碼","onUpdate:modelValue":o[1]||(o[1]=e=>d.tempCoupon.code=e)},null,512),[[b.nr,d.tempCoupon.code]])]),(0,l._)("div",P,[U,(0,l.wy)((0,l._)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":o[2]||(o[2]=e=>d.due_date=e)},null,512),[[b.nr,d.due_date]])]),(0,l._)("div",Z,[z,(0,l.wy)((0,l._)("input",{type:"number",id:"price",class:"form-control",min:"0",placeholder:"請輸入折扣百分比","onUpdate:modelValue":o[3]||(o[3]=e=>d.tempCoupon.percent=e)},null,512),[[b.nr,d.tempCoupon.percent,void 0,{number:!0}]])]),(0,l._)("div",V,[(0,l._)("div",A,[(0,l.wy)((0,l._)("input",{type:"checkbox",id:"is_enabled","true-value":1,"false-value":0,class:"form-check-input",placeholder:"請輸入折扣百分比","onUpdate:modelValue":o[4]||(o[4]=e=>d.tempCoupon.is_enabled=e)},null,512),[[b.e8,d.tempCoupon.is_enabled]]),L])])]),(0,l._)("div",I,[O,(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:o[5]||(o[5]=o=>e.$emit("update-coupon",d.tempCoupon))},(0,n.zw)(t.isNew?"新增優惠券":"更新優惠券"),1)])])])],512)}var T=t(2030),W={data(){return{tempCoupon:{},modal:"",due_date:""}},props:{coupon:{type:Object,default(){return{}}},isNew:{type:Boolean,default:!1}},mixins:[T.Z],watch:{coupon(){this.tempCoupon=this.coupon;const e=new Date(1e3*this.tempCoupon.due_date);e.toISOString().split("T")},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}}},j=t(3744);const B=(0,j.Z)(W,[["render",S]]);var H=B,K=t(4246),Y={data(){return{coupons:{},tempCoupon:{},isNew:!1,modal:{delModal:""}}},components:{AdminCouponModal:H,AdminDelProduct:K.Z},methods:{getCoupons(){const e="https://vue3-course-api.hexschool.io/v2/api/annawen/admin/coupons";this.$http.get(e).then((e=>{this.coupons=e.data.coupons})).catch((e=>{console.log(e)}))},openCouponModal(e,o){e?(this.tempCoupon={due_date:(new Date).getTime()/1e3},this.isNew=!0):(this.tempCoupon={...o},this.isNew=!1),this.$refs.couponModal.openModal()},openDelCouponModal(e){this.tempCoupon={...e},this.$refs.delModal.openModal()},delCoupon(){const e=`https://vue3-course-api.hexschool.io/v2/api/annawen/admin/coupon/${this.tempCoupon.id}`;this.$http.delete(e).then((e=>{alert(e.data.message),this.$refs.delModal.hideModal(),this.getCoupons()})).catch((e=>{console.log(e)}))},updateCoupon(e){this.tempCoupon=e;let o="https://vue3-course-api.hexschool.io/v2/api/annawen/admin/coupon",t="post";this.isNew||(o=`https://vue3-course-api.hexschool.io/v2/api/annawen/admin/coupon/${this.tempCoupon.id}`,t="put"),this.$http[t](o,{data:this.tempCoupon}).then((e=>{alert(e.data.message),this.getCoupons(),this.$refs.couponModal.hideModal()})).catch((e=>alert(e.response.data.message)))}},mounted(){this.getCoupons()}};const q=(0,j.Z)(Y,[["render",h]]);var E=q}}]);
//# sourceMappingURL=599.e2a8bd1f.js.map